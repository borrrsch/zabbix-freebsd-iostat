# Disk statistics via iostat (sysstat)
# Attention: Second parameter in iostat.collect must be less than Timeout option in zabbix_agentd.conf
UserParameter=iostat.discovery, iostat -x | awk 'BEGIN {count=0;array[0]=0;} {if($1 !~ /extended|device/){array[count]=$1;count=count+1}}END {printf("{\n\t\"data\":[\n");for(i=0;i<count;++i){printf("\t\t{\n\t\t\t\"{#HARDDISK}\":\"%s\"}", array[i]); if(i+1<count){printf(",\n");}} printf("]}\n");}'
UserParameter=iostat.collect,/usr/local/zabbix-2.4.4/zabbix_extensions/scripts/iostat-collect.sh /tmp/iostat.out 8 || echo 1
UserParameter=iostat.metric[*],/usr/local/zabbix-2.4.4/zabbix_extensions/scripts/iostat-parse.sh /tmp/iostat.out $1 $2
UserParameter=iostat.total.metric[*],/usr/local/zabbix-2.4.4/zabbix_extensions/scripts/iostat-parse.sh /tmp/iostat.out $1 $2 total 
